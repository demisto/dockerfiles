# JavaScript Pattern: DOM Clobbering Attack
# Detects DOM clobbering techniques

id: JS-024
name: DOM Clobbering Attack
description: |
  Detects DOM clobbering attacks where HTML elements with specific IDs or names
  are created to override global JavaScript variables or functions. Attackers
  use this technique to bypass security checks, manipulate application logic,
  and inject malicious behavior by exploiting how browsers expose DOM elements
  as global properties.
languages:
  - javascript
detection_type: regex
detection_logic: '\.createElement\s*\(\s*["\x27](form|input|img|iframe)["\x27]\).*\.(id|name)\s*=|document\.body\.appendChild.*\.(id|name)\s*='
severity: High
mitre_technique: T1059.007
confidence: 0.85
category: injection
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-19"
  updated: "2025-11-19"
  references:
    - "https://attack.mitre.org/techniques/T1059/007/"
    - "https://portswigger.net/web-security/dom-based/dom-clobbering"
  tags:
    - javascript
    - dom-clobbering
    - injection
    - xss
  examples:
    - "const form = document.createElement('form'); form.id = 'config';"
    - "input.name = 'apiEndpoint'; form.appendChild(input);"
    - "img.id = 'isSecure'; document.body.appendChild(img);"