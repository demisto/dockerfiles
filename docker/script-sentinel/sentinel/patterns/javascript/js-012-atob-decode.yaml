# JavaScript Pattern: Base64 Decoding for Obfuscation
# Detects base64 decoding often used in obfuscation

id: JS-012
name: Base64 Decoding Obfuscation
description: |
  Detects use of atob() for base64 decoding, commonly used to obfuscate malicious
  code. Attackers encode malicious payloads in base64 to evade static analysis
  and signature-based detection. While atob() has legitimate uses, it's frequently
  found in malicious scripts combined with eval() or Function().
languages:
  - javascript
detection_type: regex
detection_logic: '\batob\s*\('
severity: Medium
mitre_technique: T1027
confidence: 0.7
category: obfuscation
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1027/"
    - "https://developer.mozilla.org/en-US/docs/Web/API/atob"
  tags:
    - javascript
    - obfuscation
    - base64
    - encoding
  examples:
    - "eval(atob('dmFyIG1hbHdhcmUgPSAiZXZpbCI='));"
    - "var decoded = atob(encodedPayload); new Function(decoded)();"
    - "document.write(atob('PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=='));"