# JavaScript Pattern: Code Obfuscation
# Detects common JavaScript obfuscation patterns

id: JS-003
name: Obfuscated Code Detection
description: |
  Detects common JavaScript obfuscation patterns including excessive use of
  escape sequences, hex encoding, unicode escapes, and string concatenation
  with array indexing. These techniques are frequently used to hide malicious
  code from static analysis tools.
languages:
  - javascript
detection_type: regex
detection_logic: '(?:\\x[0-9a-fA-F]{2}.*){5,}|(?:\\u[0-9a-fA-F]{4}.*){5,}|(?:\[\d+\]\s*\+\s*){3,}'
severity: Medium
mitre_technique: T1027
confidence: 0.75
category: obfuscation
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-01-15"
  references:
    - "https://attack.mitre.org/techniques/T1027/"
  tags:
    - javascript
    - obfuscation
    - encoding
  examples:
    - "var x = '\\x61\\x6c\\x65\\x72\\x74\\x28\\x31\\x29'"
    - "eval('\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0031\\u0029')"
    - "var s = arr[0] + arr[1] + arr[2] + arr[3] + arr[4]"