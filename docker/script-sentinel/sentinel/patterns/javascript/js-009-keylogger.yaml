# JavaScript Pattern: Keylogger Detection
# Detects keylogging functionality

id: JS-009
name: Keylogger Detection
description: |
  Detects JavaScript keylogger implementations that capture user keystrokes.
  Attackers use keyloggers to steal passwords, credit card numbers, and other
  sensitive information entered by users. This pattern identifies event listeners
  for keyboard events combined with data collection or transmission.
languages:
  - javascript
detection_type: regex
detection_logic: '(?:addEventListener\s*\(\s*["\x27]key(?:down|up|press)|onkey(?:down|up|press)\s*=).*(?:\.key|\.keyCode|\.which)'
severity: High
mitre_technique: T1056.001
confidence: 0.8
category: collection
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1056/001/"
    - "https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent"
  tags:
    - javascript
    - keylogger
    - credential-theft
    - input-capture
  examples:
    - "document.addEventListener('keydown', function(e) { sendToServer(e.key); });"
    - "window.onkeypress = function(e) { log += e.key; };"
    - "document.onkeydown = (e) => { fetch('/log?key=' + e.keyCode); };"