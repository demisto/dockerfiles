# JavaScript Pattern: Boolean Algebra Obfuscation
# Detects boolean algebra used to obfuscate control flow

id: JS-027
name: Boolean Algebra Obfuscation
description: |
  Detects use of complex boolean algebra expressions to obfuscate control flow
  and hide malicious logic. Attackers use tautologies (always true) and
  contradictions (always false) with boolean operators to make static analysis
  more difficult while ensuring their malicious code executes.
languages:
  - javascript
detection_type: regex
detection_logic: '\(.*&&\s*!.*\)\s*\|\|\s*\(.*&&\s*!.*\)|if\s*\(\s*\(true\s*&&\s*!false\)\s*\|\||if\s*\(\s*\(.*\s*&&\s*!.*\)\s*\|\|\s*\(.*\s*&&\s*!.*\)\s*\)'
severity: High
mitre_technique: T1027
confidence: 0.80
category: obfuscation
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-19"
  updated: "2025-11-19"
  references:
    - "https://attack.mitre.org/techniques/T1027/"
  tags:
    - javascript
    - obfuscation
    - boolean-algebra
    - control-flow
  examples:
    - "if ((t && !f) || (f && !t)) { malicious(); }"
    - "if ((true && !false) || (false && !true)) { }"
    - "while ((x && !y) || (y && !x)) { }"