# JavaScript Pattern: DOM Clobbering
# Detects DOM clobbering techniques

id: JS-018
name: DOM Clobbering Attack
description: |
  Detects DOM clobbering attempts where attackers inject HTML elements with
  specific id or name attributes to override JavaScript variables and functions.
  This technique exploits how browsers create global variables from element IDs,
  potentially leading to XSS or logic bypass vulnerabilities.
languages:
  - javascript
detection_type: regex
detection_logic: '(?:getElementById|getElementsByName|document\[[\x27"]|\[name=).*(?:=.*createElement|innerHTML.*(?:id=|name=))'
severity: Medium
mitre_technique: T1059.007
confidence: 0.7
category: injection
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1059/007/"
    - "https://portswigger.net/web-security/dom-based/dom-clobbering"
  tags:
    - javascript
    - dom-clobbering
    - xss
    - injection
  examples:
    - "document.body.innerHTML = '<form name=\"config\"><input name=\"apiUrl\" value=\"http://evil.com\"></form>';"
    - "var elem = document.createElement('a'); elem.id = 'config'; elem.href = 'javascript:alert(1)';"
    - "<img name=x id=x src=x onerror=alert(1)>"