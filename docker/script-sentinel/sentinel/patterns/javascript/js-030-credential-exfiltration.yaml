# JavaScript Pattern: Credential Exfiltration via POST
# Detects phishing scripts that exfiltrate credentials

id: JS-030
name: Credential Exfiltration via POST
description: |
  Detects JavaScript that sends credentials or form data to PHP scripts for exfiltration.
  Common in phishing attacks where fake login forms capture and send credentials to
  attacker-controlled servers.
languages:
  - javascript
detection_type: regex
detection_logic: '(?i)(?:\$\.post|fetch|XMLHttpRequest).*?(?:sendmail\.php|login\.php|auth\.php|post\.php).*?(?:password|passwd|pwd|paswrd)'
severity: Critical
mitre_technique: T1056.003
confidence: 0.9
category: credential-theft
enabled: true
paranoia_levels:
  - 1
  - 2
  - 3
metadata:
  author: Script Sentinel Team
  created: "2025-11-25"
  updated: "2025-11-25"
  references:
    - "https://attack.mitre.org/techniques/T1056/003/"
    - "https://attack.mitre.org/techniques/T1041/"
  tags:
    - javascript
    - credential-theft
    - phishing
    - exfiltration
  examples:
    - "$.post('sendmail.php',{'postemail':email,'postpaswrd':password})"
    - "fetch('login.php', {method: 'POST', body: JSON.stringify({password: pwd})})"