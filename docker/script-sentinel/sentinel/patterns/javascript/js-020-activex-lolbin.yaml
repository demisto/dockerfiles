# JavaScript Pattern: ActiveX LOLBin Abuse
# Detects ActiveX usage for file downloads and execution

id: JS-020
name: ActiveX LOLBin Abuse
description: |
  Detects abuse of ActiveX objects (Microsoft.XMLHTTP, ADODB.Stream, WScript.Shell)
  for downloading files, executing commands, or performing malicious operations.
  ActiveX is commonly used in malicious scripts for file operations and code execution.
languages:
  - javascript
detection_type: regex
detection_logic: 'new\s+ActiveXObject\s*\(\s*["\x27](?:Microsoft\.XMLHTTP|MSXML2\.XMLHTTP|ADODB\.Stream|WScript\.Shell|Scripting\.FileSystemObject)["\x27]\s*\)'
severity: High
mitre_technique: T1059.007
confidence: 0.85
category: execution
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-01-19"
  references:
    - "https://attack.mitre.org/techniques/T1059/007/"
    - "https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms535874(v=vs.85)"
  tags:
    - lolbin
    - activex
    - download
    - code-execution
  examples:
    - "var xhr = new ActiveXObject(\"Microsoft.XMLHTTP\");"
    - "var stream = new ActiveXObject(\"ADODB.Stream\");"
    - "var shell = new ActiveXObject(\"WScript.Shell\");"