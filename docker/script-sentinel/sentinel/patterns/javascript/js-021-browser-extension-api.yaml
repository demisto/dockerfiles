# JavaScript Pattern: Browser Extension API Abuse
# Detects malicious use of browser extension APIs

id: JS-021
name: Browser Extension API Abuse
description: |
  Detects suspicious use of browser extension APIs (Chrome/Firefox) that could
  indicate malicious extension injection or abuse. Attackers use extension APIs
  to intercept network traffic, steal cookies, modify web pages, and maintain
  persistence across browser sessions.
languages:
  - javascript
detection_type: regex
detection_logic: 'chrome\.(runtime|webRequest|cookies|storage|tabs|management)|browser\.(runtime|webRequest|cookies|storage|tabs)|chrome\.management\.install|addListener.*webRequest'
severity: Critical
mitre_technique: T1176
confidence: 0.9
category: persistence
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-19"
  updated: "2025-11-19"
  references:
    - "https://attack.mitre.org/techniques/T1176/"
    - "https://developer.chrome.com/docs/extensions/reference/"
  tags:
    - javascript
    - browser-extension
    - persistence
    - chrome
    - firefox
  examples:
    - "chrome.webRequest.onBeforeRequest.addListener()"
    - "chrome.cookies.getAll({}, function(cookies) {})"
    - "chrome.management.install({url: url})"
    - "browser.runtime.sendMessage()"