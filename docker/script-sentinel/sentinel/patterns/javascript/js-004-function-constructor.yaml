# JavaScript Pattern: Function Constructor Usage
# Detects use of Function constructor for code execution

id: JS-004
name: Function Constructor Code Execution
description: |
  Detects use of the Function constructor to create and execute dynamic code.
  Similar to eval(), the Function constructor can execute arbitrary JavaScript
  from strings, making it a vector for code injection attacks. Attackers use
  this to bypass static analysis and execute malicious code.
languages:
  - javascript
detection_type: regex
detection_logic: '\bnew\s+Function\s*\(|Function\s*\(\s*["\x27]'
severity: High
mitre_technique: T1059.007
confidence: 0.85
category: command_injection
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1059/007/"
    - "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function"
  tags:
    - javascript
    - code-execution
    - function-constructor
    - injection
  examples:
    - "var fn = new Function('return ' + userInput); fn();"
    - "const execute = Function('a', 'b', 'return a + b');"
    - "(new Function(maliciousCode))()"