# JavaScript Pattern: Anti-Debugging Techniques
# Detects debugger statements and anti-debugging tricks

id: JS-026
name: Anti-Debugging Detection
description: |
  Detects JavaScript anti-debugging techniques including debugger statements,
  timing-based detection, DevTools detection, and function integrity checks.
  Attackers use these to prevent analysis and reverse engineering of malicious code.
languages:
  - javascript
detection_type: regex
detection_logic: '\bdebugger\b|performance\.now\(\)|console\.(log|dir|profile)|\.toString\(\)\s*!==|devtools|Function\.prototype\.toString'
severity: High
mitre_technique: T1622
confidence: 0.85
category: evasion
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-19"
  updated: "2025-11-19"
  references:
    - "https://attack.mitre.org/techniques/T1622/"
    - "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/debugger"
  tags:
    - javascript
    - anti-debugging
    - evasion
    - debugger
  examples:
    - "debugger;"
    - "const start = performance.now(); debugger; const end = performance.now();"
    - "if (fetch.toString() !== originalFetch) { throw new Error(); }"