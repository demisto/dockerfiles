# Bash Pattern: Backdoor User Account Creation
# Detects creation of backdoor user accounts

id: BASH-015
name: Backdoor User Account Creation
description: |
  Detects creation of backdoor user accounts for persistence. Attackers create
  new user accounts or modify existing ones to maintain access. This pattern
  identifies useradd, usermod, and direct /etc/passwd manipulation for creating
  privileged or hidden user accounts.
languages:
  - bash
detection_type: regex
detection_logic: '(?:useradd.*-o.*-u\s*0|echo.*:0:0:.*>>\s*/etc/passwd|usermod.*-u\s*0|echo.*\$.*\$.*>>\s*/etc/shadow)'
severity: High
mitre_technique: T1136.001
confidence: 0.9
category: persistence
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1136/001/"
    - "https://man7.org/linux/man-pages/man8/useradd.8.html"
  tags:
    - bash
    - user-creation
    - persistence
    - privilege-escalation
  examples:
    - "useradd -o -u 0 -g 0 -M -d /root -s /bin/bash backdoor"
    - "echo 'hacker:x:0:0:root:/root:/bin/bash' >> /etc/passwd"
    - "usermod -u 0 -g 0 normaluser"
    - "echo 'backdoor:$6$salt$hash:18000:0:99999:7:::' >> /etc/shadow"