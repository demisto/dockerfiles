# Bash Pattern: Port Scanning
# Detects port scanning using /dev/tcp or similar techniques

id: BASH-024
name: Port Scanning Activity
description: |
  Detects port scanning using Bash's /dev/tcp pseudo-device in loops or with
  variable expansion. Single /dev/tcp connections are common for health checks.
  Pattern focuses on loop constructs ({1..N}, $port variables) which indicate
  scanning behavior rather than legitimate single-port connectivity tests.
languages:
  - bash
detection_type: regex
# Focus on loop/variable patterns with /dev/tcp - single connections are common for health checks
detection_logic: '(?:/dev/tcp/|/dev/udp/).*(?:\{1\.\.\d+\}|\$\{?\w+\}?)|for\b.*(?:/dev/tcp|/dev/udp)'
severity: Low
mitre_technique: T1046
confidence: 0.70
category: discovery
enabled: true
paranoia_levels:
  - 2
  - 3
metadata:
  author: Script Sentinel Team
  created: "2025-01-19"
  references:
    - "https://attack.mitre.org/techniques/T1046/"
    - "https://www.gnu.org/software/bash/manual/html_node/Redirections.html"
  tags:
    - port-scanning
    - network-reconnaissance
    - discovery
  examples:
    - "for port in {1..1024}; do echo >/dev/tcp/$HOST/$port; done"
    - "timeout 1 bash -c \"echo >/dev/tcp/192.168.1.1/$port\""