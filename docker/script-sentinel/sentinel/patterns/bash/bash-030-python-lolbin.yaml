# Bash Pattern: Python LOLBin Abuse
# Detects python usage for reverse shells and malicious operations

id: BASH-030
name: Python LOLBin Abuse
description: |
  Detects abuse of Python as a Living Off The Land Binary for establishing
  reverse shells, executing arbitrary code, or performing network operations.
  Python's socket, subprocess, and os modules make it powerful for attackers.
languages:
  - bash
detection_type: regex
detection_logic: '\bpython\b\s+-c.*(?:socket|subprocess|os\.dup2|pty\.spawn)|\bpython\b.*(?:import\s+socket|import\s+subprocess|\.connect\(|\.fileno\(\))'
severity: High
mitre_technique: T1059.006
confidence: 0.85
category: execution
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-01-19"
  references:
    - "https://attack.mitre.org/techniques/T1059/006/"
    - "https://gtfobins.github.io/gtfobins/python/"
  tags:
    - lolbin
    - python
    - reverse-shell
    - code-execution
  examples:
    - "python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",1234));'"
    - "python -c 'import pty;pty.spawn(\"/bin/bash\")'"