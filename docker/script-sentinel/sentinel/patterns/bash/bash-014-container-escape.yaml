# Bash Pattern: Container Escape Attempts
# Detects attempts to escape from containers

id: BASH-014
name: Container Escape Attempts
description: |
  Detects techniques used to escape from containerized environments like Docker.
  Focus on high-confidence escape techniques: nsenter to PID 1, docker with
  privileged + host mount, and capability manipulation. Simple docker socket
  access is common for legitimate container management tools.
languages:
  - bash
detection_type: regex
# Focus on high-confidence escape patterns
# Simple docker.sock access is common for legitimate tooling
detection_logic: 'nsenter\b.*-t\s*1|docker\b.*--privileged.*-v\s*/:/|capsh\b.*--caps=.*cap_sys|unshare\b.*(?:-m.*-p|-p.*-m).*chroot'
severity: High
mitre_technique: T1611
confidence: 0.75
category: privilege_escalation
enabled: true
paranoia_levels:
  - 1
  - 2
  - 3
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1611/"
    - "https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation"
  tags:
    - bash
    - container-escape
    - docker
    - privilege-escalation
  examples:
    - "docker run --privileged -v /:/host alpine chroot /host"
    - "nsenter -t 1 -m -u -i -n -p -- bash"
    - "curl --unix-socket /var/run/docker.sock http://localhost/containers/json"