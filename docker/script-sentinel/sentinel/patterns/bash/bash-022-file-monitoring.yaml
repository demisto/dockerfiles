# Bash Pattern: File System Monitoring
# Detects use of inotifywait for file system monitoring

id: BASH-022
name: File System Monitoring
description: |
  Detects use of inotifywait or similar tools to monitor file system changes.
  While legitimate for system administration, attackers may use this to track
  user activity, monitor sensitive files, or detect security tool execution.
  This pattern identifies file monitoring that could indicate surveillance.
languages:
  - bash
detection_type: regex
detection_logic: 'inotifywait\s+.*(?:-m|--monitor|--recursive|-r)'
severity: Low
mitre_technique: T1083
confidence: 0.65
category: discovery
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-01-19"
  references:
    - "https://attack.mitre.org/techniques/T1083/"
    - "https://linux.die.net/man/1/inotifywait"
  tags:
    - file-monitoring
    - surveillance
    - discovery
  examples:
    - "inotifywait -m -r -e modify,create,delete /home"
    - "inotifywait --monitor --recursive /etc"