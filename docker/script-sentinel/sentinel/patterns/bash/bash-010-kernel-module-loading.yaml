# Bash Pattern: Kernel Module Loading
# Detects loading of kernel modules for rootkits

id: BASH-010
name: Kernel Module Loading
description: |
  Detects attempts to load kernel modules which may be used for rootkits or
  kernel-level persistence. Attackers load malicious kernel modules to hide
  processes, files, and network connections. This pattern identifies insmod,
  modprobe, and direct module loading attempts.
languages:
  - bash
detection_type: regex
detection_logic: '(?:insmod|modprobe|rmmod).*\.ko|echo.*>\s*/proc/sys/kernel/modprobe'
severity: High
mitre_technique: T1547.006
confidence: 0.9
category: persistence
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1547/006/"
    - "https://www.kernel.org/doc/html/latest/kbuild/modules.html"
  tags:
    - bash
    - kernel-module
    - rootkit
    - persistence
  examples:
    - "insmod /tmp/rootkit.ko"
    - "modprobe -r legitimate_module && modprobe malicious_module"
    - "echo '/tmp/evil.ko' > /proc/sys/kernel/modprobe"