# Bash Pattern: Arithmetic Encoding Obfuscation
# Detects arithmetic encoding used to hide commands

id: BASH-026
name: Arithmetic Encoding Obfuscation
description: |
  Detects use of arithmetic expansion combined with printf to encode commands
  as numeric values. Attackers use this technique to hide malicious command
  strings from static analysis by representing characters as decimal or octal
  values that are decoded at runtime.
languages:
  - bash
detection_type: regex
detection_logic: '\$\(\(.*[0-9]{2,3}.*\)\).*printf.*%[0-9]*[odx]|\$\(\(.*\+.*\)\).*printf|printf.*%03o.*\$\(\('
severity: High
mitre_technique: T1027
confidence: 0.85
category: obfuscation
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-19"
  updated: "2025-11-19"
  references:
    - "https://attack.mitre.org/techniques/T1027/"
  tags:
    - bash
    - obfuscation
    - encoding
    - arithmetic
  examples:
    - 'a=$((99+18)); cmd=$(printf "%03o" $a)'
    - '$((117)) | printf "%d"'
    - 'printf "\\$(printf "%03o" $a)"'