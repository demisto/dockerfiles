# PowerShell Pattern: PowerShell Remoting
# Detects PowerShell remoting for lateral movement

id: PS-009
name: PowerShell Remoting Usage
description: |
  Detects use of PowerShell remoting cmdlets for remote command execution.
  While PowerShell remoting is a legitimate administrative tool, attackers
  frequently abuse it for lateral movement and remote code execution on
  compromised networks. This pattern identifies Enter-PSSession, Invoke-Command,
  and New-PSSession usage.
languages:
  - powershell
detection_type: regex
detection_logic: '(?i)(?:Enter-PSSession|Invoke-Command|New-PSSession|Enable-PSRemoting).*(?:-ComputerName|-Session|-ConnectionUri)'
severity: Medium
mitre_technique: T1021.006
confidence: 0.75
category: lateral_movement
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1021/006/"
    - "https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/running-remote-commands"
  tags:
    - powershell
    - remoting
    - lateral-movement
    - execution
  examples:
    - "Enter-PSSession -ComputerName Server01 -Credential $cred"
    - "Invoke-Command -ComputerName DC01 -ScriptBlock { Get-Process }"
    - "$session = New-PSSession -ComputerName 192.168.1.100"