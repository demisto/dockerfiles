# PowerShell Pattern: Process Monitoring
# Detects continuous process monitoring activity

id: PS-025
name: Process Monitoring Activity
description: |
  Detects continuous monitoring of running processes using Get-Process in loops.
  While legitimate for system administration, attackers use process monitoring to
  track security tools, identify targets, or wait for specific processes. This
  pattern identifies surveillance activity that could indicate reconnaissance.
languages:
  - powershell
detection_type: regex
detection_logic: '(?:while|for|foreach).*Get-Process.*(?:CPU|Memory|WorkingSet|Path)'
severity: Low
mitre_technique: T1057
confidence: 0.65
category: discovery
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-01-19"
  references:
    - "https://attack.mitre.org/techniques/T1057/"
    - "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-process"
  tags:
    - process-monitoring
    - surveillance
    - discovery
  examples:
    - "while ($true) { Get-Process | Where-Object {$_.CPU -gt 50} }"
    - "foreach ($proc in Get-Process) { $proc.WorkingSet64 }"