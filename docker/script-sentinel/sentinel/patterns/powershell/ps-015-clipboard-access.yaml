# PowerShell Pattern: Clipboard Data Access
# Detects clipboard data collection

id: PS-015
name: Clipboard Data Collection
description: |
  Detects PowerShell commands that access clipboard data. Attackers may monitor
  or steal clipboard contents to capture sensitive information like passwords,
  credit card numbers, or other data copied by users. This pattern identifies
  Get-Clipboard and Windows.Forms clipboard access.
languages:
  - powershell
detection_type: regex
detection_logic: '(?i)(?:Get-Clipboard|\[Windows\.Forms\.Clipboard\]::GetText|\[System\.Windows\.Forms\.Clipboard\])'
severity: Medium
mitre_technique: T1115
confidence: 0.85
category: collection
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1115/"
    - "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-clipboard"
  tags:
    - powershell
    - clipboard
    - collection
    - data-theft
  examples:
    - "$clip = Get-Clipboard; Send-ToC2Server $clip"
    - "while($true) { $data = Get-Clipboard; if($data -match 'password') { Log-Data $data }; Start-Sleep 5 }"
    - "Add-Type -AssemblyName System.Windows.Forms; [System.Windows.Forms.Clipboard]::GetText()"