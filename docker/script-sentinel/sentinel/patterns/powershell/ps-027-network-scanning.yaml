# PowerShell Pattern: Network Scanning with Test-Connection
# Detects network scanning activity using Test-Connection cmdlet

id: PS-027
name: Network Scanning Activity
description: |
  Detects network scanning using Test-Connection cmdlet in loops or with
  IP ranges. While legitimate for network administration, attackers use
  network scanning to discover live hosts, map network topology, and
  identify potential targets. This pattern identifies reconnaissance
  activity targeting network infrastructure.
languages:
  - powershell
detection_type: regex
detection_logic: '(?:Test-Connection|Test-NetConnection).*(?:ForEach|1\.\.\d+|\$ip)'
severity: Low
mitre_technique: T1046
confidence: 0.65
category: discovery
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-01-19"
  references:
    - "https://attack.mitre.org/techniques/T1046/"
    - "https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/test-connection"
  tags:
    - network-scanning
    - reconnaissance
    - discovery
  examples:
    - "1..254 | ForEach-Object { Test-Connection -ComputerName \"192.168.1.$_\" }"
    - "Test-Connection -ComputerName $ip -Count 1 -Quiet"