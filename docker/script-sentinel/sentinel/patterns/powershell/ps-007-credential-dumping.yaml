# PowerShell Pattern: Credential Dumping
# Detects credential harvesting attempts

id: PS-007
name: Credential Dumping Attempts
description: |
  Detects PowerShell commands attempting to dump credentials from memory or
  system stores. This includes references to common credential dumping tools
  like Mimikatz, as well as direct access to LSASS process memory or SAM/SYSTEM
  registry hives. Credential dumping is a critical post-exploitation technique.
languages:
  - powershell
detection_type: regex
detection_logic: '(?i)(?:mimikatz|Invoke-Mimikatz|sekurlsa|lsadump|Get-Process\s+lsass|procdump.*lsass|reg\s+save.*(?:SAM|SYSTEM|SECURITY))'
severity: Critical
mitre_technique: T1003
confidence: 0.95
category: credential_access
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1003/"
    - "https://github.com/gentilkiwi/mimikatz"
  tags:
    - powershell
    - credential-dumping
    - mimikatz
    - lsass
  examples:
    - "Invoke-Mimikatz -Command 'sekurlsa::logonpasswords'"
    - "Get-Process lsass | Out-Minidump"
    - "reg save HKLM\\SAM C:\\temp\\sam.hive"
    - "procdump -ma lsass.exe lsass.dmp"